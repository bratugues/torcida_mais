<div data-controller="calendar" class="matches-page">

  <div class="matches-header">
    <%= form_with url: matches_path, method: :get, local: true, class: "filters d-inline-flex align-items-center gap-2" do %>
    <label for="date-selector" class="filters__label mb-0">
      <i class="fa-solid fa-calendar forest"></i>
    </label>

    <%= date_field_tag :date,
                       params[:date],
                       id: "date-selector",
                       class: "date-input form-control",
                       onchange: "this.form.submit()" %>

      <% if params[:date].present? %>
        <button type="button"
                class="btn btn-sm btn-link p-0"
                onclick="this.form.querySelector('#date-selector').value=''; this.form.submit();">
          clear
        </button>
      <% end %>
    <% end %>

    <%= link_to " Back ", dashboard_path, class: "btn btn-secondary" %>
  </div>

  <div class="matches-list mt-2">
    <% @matches.each do |match| %>
      <% dt = match.played_at %>
      <% date_for_js   = dt.strftime('%Y-%m-%d') %>
      <% date_for_user = dt.strftime('%d/%m/%Y') %>
      <% time_for_user = dt.strftime('%H:%M') %>

      <div class="match-card" data-calendar-target="match" data-date="<%= date_for_js %>">
        <div class="match-info">
        <div class="match-title">
          <%= image_tag match.home_team.shield_path, class: "team-shield" %>
          <span class="team-name home"><%= match.home_team.name %></span>
          <span class="vs">vs</span>
          <span class="team-name away"><%= match.away_team.name %></span>
          <%= image_tag match.away_team.shield_path, class: "team-shield" %>
        </div>
      <div class="match-meta">
        <span class="chip"><%= date_for_user %></span>
        <span class="chip"><%= time_for_user %></span>
      </div>
    </div>

    <%= link_to "See events", events_path(q: match.title, on: date_for_js),
                class: "btn btn-secondary" %>
  </div>
    <% end %>
  </div>
</div>
